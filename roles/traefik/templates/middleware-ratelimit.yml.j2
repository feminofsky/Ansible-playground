# Rate limit middleware â€” deploy to traefik + all IngressRoute namespaces (Traefik CRD requires same-namespace)
{% for ns in ([traefik_namespace] + (subdomains | map(attribute='namespace') | unique | list) + ([monitoring_namespace] if (monitoring_enabled | default(false)) else [])) | unique %}
---
apiVersion: {{ traefik_crd_api_group | default('traefik.io') }}/v1alpha1
kind: Middleware
metadata:
  name: rate-limit
  namespace: {{ ns }}
spec:
  rateLimit:
    average: 100
    period: 1m
    burst: 50
{% endfor %}
